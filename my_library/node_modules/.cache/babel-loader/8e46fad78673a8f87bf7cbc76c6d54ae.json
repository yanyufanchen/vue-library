{"remainingRequest":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\src\\components\\Book\\BookInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\src\\components\\Book\\BookInfo.vue","mtime":1578117510863},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\wangpeng\\Desktop\\mt\\vue-ht\\library\\my_library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\wangpeng\\\\Desktop\\\\mt\\\\vue-ht\\\\library\\\\my_library\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { books_api, getBooks_api, upBooks_api, addBooks_api, deleteBooks_api, getAuthorinfo, getBookinfo } from '@/api';\nimport moment from 'moment'; // 时间过滤插件\n\nexport default {\n  data: function data() {\n    return {\n      common: ['Book Info'],\n      // 公共组件传值\n      input1: '',\n      value1: '',\n      allCount: null,\n      currentPage: 1,\n      pageSize: 10,\n      tableData: [],\n      gridData: [],\n      bookData: [],\n      dialogFormVisible: false,\n      editFormVisible: false,\n      dialoginfo: false,\n      dialogBookinfo: false,\n      show: true,\n      addForm: {\n        title: '',\n        isbn: '',\n        name: ''\n      },\n      editRegion: {\n        title: '',\n        isbn: '',\n        name: ''\n      },\n      formLabelWidth: '140px',\n      rules: {\n        title: [{\n          required: true,\n          message: 'please input title',\n          trigger: 'blur'\n        }],\n        isbn: [{\n          required: true,\n          message: 'please input number',\n          trigger: 'blur'\n        }, {\n          type: 'string',\n          pattern: /^[0-9]{1,22}$/,\n          // 正则表达式验证\n          message: 'Please enter a number number！',\n          trigger: 'blur'\n        }],\n        name: [{\n          required: true,\n          message: 'please input author',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  filters: {\n    formatDate: function formatDate(value) {\n      return moment(value).format('YYYY-MM-DD');\n    }\n  },\n  created: function created() {\n    this.getBookAll();\n  },\n  methods: {\n    // 清除clearInput\n    clear: function clear() {\n      this.show = true;\n      this.getBookAll();\n    },\n    //获取图书信息\n    openBook: function openBook(id) {\n      var _this = this;\n\n      var params = {\n        id: id\n      };\n      getBookinfo(params).then(function (res) {\n        if (res.status == 200) {\n          _this.dialogBookinfo = true;\n          _this.bookData = res.data.data;\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    //获取作者信息\n    open: function open(id) {\n      var _this2 = this;\n\n      var params = {\n        id: id\n      };\n      getAuthorinfo(params).then(function (res) {\n        if (res.status == 200) {\n          _this2.dialoginfo = true;\n          _this2.gridData = res.data.data;\n        }\n      }).catch(function (err) {\n        console.log(err);\n      });\n    },\n    getBookAll: function () {\n      var _getBookAll = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var params, _ref, res, i;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // 刷新home页面就请求图书信息\n                params = {\n                  \"pagesize\": this.pageSize,\n                  \"pageNO\": this.currentPage\n                };\n                _context.next = 3;\n                return books_api(params);\n\n              case 3:\n                _ref = _context.sent;\n                res = _ref.data;\n\n                if (!(res.status !== 200)) {\n                  _context.next = 7;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", this.$message.error(res.msg));\n\n              case 7:\n                for (i in res.data) {\n                  res.data[i].createdAt = moment(res.data[i].createdAt).format('YYYY-MM-DD');\n                } // console.log(res)\n\n\n                this.tableData = res.data;\n                this.allCount = res.total;\n\n              case 10:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getBookAll() {\n        return _getBookAll.apply(this, arguments);\n      }\n\n      return getBookAll;\n    }(),\n    //分页\n    handleCurrentChange: function () {\n      var _handleCurrentChange = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(currentPage) {\n        var params, _ref2, res, i;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.currentPage = currentPage;\n                params = {\n                  \"pagesize\": this.pageSize,\n                  \"pageNO\": this.currentPage\n                };\n                _context2.next = 4;\n                return books_api(params);\n\n              case 4:\n                _ref2 = _context2.sent;\n                res = _ref2.data;\n\n                if (!(res.status !== 200)) {\n                  _context2.next = 8;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", this.$message.error(res.msg));\n\n              case 8:\n                for (i in res.data) {\n                  res.data[i].createdAt = moment(res.data[i].createdAt).format('YYYY-MM-DD');\n                } // console.log(res)\n\n\n                this.tableData = res.data;\n                this.allCount = res.total;\n\n              case 11:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function handleCurrentChange(_x) {\n        return _handleCurrentChange.apply(this, arguments);\n      }\n\n      return handleCurrentChange;\n    }(),\n    reset: function reset() {\n      // 重置功能\n      this.input1 = '', this.value1 = '';\n    },\n    //add\n    submitForm: function submitForm(formName) {\n      var _this3 = this;\n\n      var that = this;\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var params = {\n            \"bookTitle\": that.addForm.title,\n            \"bookIsbn\": that.addForm.isbn,\n            \"authorName\": that.addForm.name\n          };\n\n          _this3.$confirm('Whether to commit', {\n            confirmButtonText: 'confirm',\n            cancelButtonText: 'cancel',\n            type: 'warning',\n            center: true\n          }).then(function () {\n            //ajax\n            addBooks_api(params).then(function (res) {\n              if (res.data.status === 200) {\n                //此处的表单验证\n                that.dialogFormVisible = false;\n                that.getBookAll(); //重新渲染数据\n              } else {\n                that.$confirm(res.result.msg, 'hint', {\n                  type: 'warning'\n                });\n              }\n            }).catch(function (err) {\n              console.log(err);\n            });\n          }).catch(function (err) {\n            console.log('Cancel');\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    // edit\n    handleEdit: function handleEdit(index, row) {\n      this.editFormVisible = true;\n      this.editRegion = Object.assign({}, row); // 这句是关键！！！\n    },\n    editSubmitRegion: function editSubmitRegion(formName) {\n      var _this4 = this;\n\n      var that = this;\n      this.$refs[formName].validate(function (valid) {\n        if (valid) {\n          var params = {\n            \"bookId\": that.editRegion.id,\n            \"authorName\": that.editRegion.name,\n            \"bookTitle\": that.editRegion.title,\n            \"bookIsbn\": that.editRegion.isbn // console.log(params)\n\n          };\n\n          _this4.$confirm('Whether to commit', {\n            confirmButtonText: 'confirm',\n            cancelButtonText: 'cancel',\n            type: 'warning',\n            center: true\n          }).then(function () {\n            //ajax\n            upBooks_api(params).then(function (res) {\n              console.log(res.data.status);\n\n              if (res.data.status === 200) {\n                that.editFormVisible = false;\n                that.getBookAll(); //重新渲染数据\n              } else if (res.result.status == 2) {\n                that.$confirm(res.result.msg, 'hint', {\n                  type: 'warning'\n                });\n              }\n            }).catch(function (err) {\n              console.log(err);\n            });\n          }).catch(function (err) {\n            console.log('Cancel');\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    // query\n    searchClick: function searchClick() {\n      var _this5 = this;\n\n      // 查询功能\n      // 获取当前页面的信息，发送给后台 刷新页面\n      var nameCom = this.input1; // 书名\n\n      var cardCom = this.value1; // 书名编号\n\n      if (nameCom == '' && cardCom == '') {\n        this.show = true;\n        this.getBookAll();\n      } else {\n        var params = {\n          \"bookTitle\": nameCom,\n          \"bookIsbn\": parseInt(cardCom)\n        };\n        getBooks_api(params).then(function (res) {\n          if (res.data.status !== 200) {\n            return _this5.$message.error(res.data.msg);\n          } else {\n            // res.data.data.createdAt = moment(res.data.data.createdAt).format('YYYY-MM-DD')\n            var arr = [];\n            arr.push(res.data.data);\n            _this5.tableData = arr;\n            _this5.show = false;\n          }\n        });\n      }\n    },\n    // delete\n    handleDelete: function handleDelete(index, row) {\n      var _self = this;\n\n      this.$confirm('Are you sure to delete?', 'hint', {\n        confirmButtonText: 'delete',\n        cancelButtonText: 'waiting',\n        type: 'warning',\n        center: true\n      }).then(function () {\n        var params = {\n          bookId: row.id\n        };\n        deleteBooks_api({\n          data: params\n        }).then(function (res) {\n          console.log(res);\n\n          if (res.status == 200) {\n            _self.$message({\n              message: 'successfully delete',\n              type: 'success'\n            });\n\n            _self.getBookAll(); //重新渲染数据\n\n          }\n        }).catch(function (err) {\n          console.log(err);\n        });\n      }).catch(function (e) {\n        if (e != 'cancel') {\n          console.log('error' + e);\n        }\n      });\n    }\n  },\n  mounted: function mounted() {}\n};",{"version":3,"sources":["BookInfo.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div>\r\n    <!-- 导航 -->\r\n    <Breadcrumb :value=\"common\"></Breadcrumb>\r\n    <el-card class=\"box-card\">\r\n      <el-row class=\"checking\">\r\n        <el-col :span=\"20\">\r\n          <div class=\"grid-content bg-purple\">\r\n            <span class=\"com_title\">Title of book：</span>\r\n            <el-input\r\n              class=\"codeName\"\r\n              ref=\"com_name\"\r\n              placeholder=\"Please enter the title\"\r\n              v-model=\"input1\"\r\n              size=\"small\"\r\n              clearable\r\n              @clear=\"clear\"\r\n            ></el-input>\r\n            <span class=\"com_title\">Book bar code：</span>\r\n            <el-input\r\n              class=\"codeName\"\r\n              ref=\"com_code\"\r\n              placeholder=\"Please enter barcode\"\r\n              v-model=\"value1\"\r\n              size=\"small\"\r\n              clearable\r\n              @clear=\"clear\"\r\n            ></el-input>\r\n            <el-button type=\"info\" size=\"small\" @click=\"searchClick\">Query</el-button>\r\n            <!-- //查询 -->\r\n            <el-button plain size=\"small\" @click=\"reset\">Reset</el-button>\r\n            <!-- // 重置 -->\r\n          </div>\r\n        </el-col>\r\n        <el-col :span=\"4\">\r\n          <div class=\"grid-content bg-purple-light\">\r\n            <el-button\r\n              type=\"info\"\r\n              size=\"small\"\r\n              @click=\"dialogFormVisible = true\"\r\n              class=\"add\"\r\n            >Add new book</el-button>\r\n          </div>\r\n        </el-col>\r\n      </el-row>\r\n      <el-table :data=\"tableData\" style=\"width: 100%\">\r\n        <el-table-column prop=\"title\" label=\"Title of book\">\r\n          <template slot-scope=\"scope\">\r\n            <a href=\"javascript:;\" class=\"author\" @click=\"openBook(scope.row.id)\">{{scope.row.title}}</a>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"isbn\" label=\"Book bar code\"></el-table-column>\r\n        <el-table-column label=\"Book author\">\r\n          <template slot-scope=\"scope\">\r\n            <a href=\"javascript:;\" class=\"author\" @click=\"open(scope.row.authorId)\">{{scope.row.name}}</a>\r\n          </template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"createdAt\" label=\"date\"></el-table-column>\r\n        <el-table-column label=\"Operation\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button size=\"mini\" @click=\"handleEdit(scope.$index, scope.row)\">Edit</el-button>\r\n            <!-- 编辑 -->\r\n            <el-button\r\n              size=\"mini\"\r\n              type=\"danger\"\r\n              @click=\"handleDelete(scope.$index, scope.row)\"\r\n            >Delete</el-button>\r\n            <!-- 删除 -->\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <el-pagination\r\n        v-if=\"show\"\r\n        class=\"page_size\"\r\n        background=\"\"\r\n        layout=\"prev, pager, next\"\r\n        :page-size=\"pageSize\"\r\n        :current-page=\"currentPage\"\r\n        @current-change=\"handleCurrentChange\"\r\n        :total=\"allCount\"\r\n      ></el-pagination>\r\n      <el-dialog title=\"add book\" :visible.sync=\"dialogFormVisible\">\r\n        <el-form :model=\"addForm\" :rules=\"rules\" ref=\"addForm\">\r\n          <el-form-item label=\"book title\" prop=\"title\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"addForm.title\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"number\" prop=\"isbn\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"addForm.isbn\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"author\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"addForm.name\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click=\"dialogFormVisible = false\">cancel</el-button>\r\n          <el-button size=\"small\" type=\"info\" @click=\"submitForm('addForm')\">confirm</el-button>\r\n        </div>\r\n      </el-dialog>\r\n      <el-dialog title=\"edit\" :visible.sync=\"editFormVisible\">\r\n        <el-form :model=\"editRegion\" :rules=\"rules\" ref=\"editRegion\">\r\n          <el-form-item label=\"book title\" prop=\"title\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"editRegion.title\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"number\" prop=\"isbn\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"editRegion.isbn\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n          <el-form-item label=\"author\" prop=\"name\" :label-width=\"formLabelWidth\">\r\n            <el-input v-model=\"editRegion.name\" autocomplete=\"off\" clearable></el-input>\r\n          </el-form-item>\r\n        </el-form>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click.native=\"editFormVisible = false\">edit</el-button>\r\n          <el-button size=\"small\" type=\"info\" @click=\"editSubmitRegion('editRegion')\">confirm</el-button>\r\n        </div>\r\n      </el-dialog>\r\n      <!-- //根据作者获取作品 -->\r\n      <el-dialog title=\"information\" :visible.sync=\"dialoginfo\">\r\n        <el-table :data=\"gridData\">\r\n          <el-table-column property=\"id\" label=\"id\"></el-table-column>\r\n          <el-table-column property=\"title\" label=\"book title\"></el-table-column>\r\n          <el-table-column property=\"isbn\" label=\"number\"></el-table-column>\r\n        </el-table>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click=\"dialoginfo = false\">cancel</el-button>\r\n        </div>\r\n      </el-dialog>\r\n      <!-- //根据书名获取信息 -->\r\n      <el-dialog title=\"detailed information\" :visible.sync=\"dialogBookinfo\">\r\n        <el-table :data=\"bookData\">\r\n          <el-table-column property=\"title\" label=\"Title\"></el-table-column>\r\n          <el-table-column property=\"isbn\" label=\"ISBN\"></el-table-column>\r\n          <el-table-column property=\"name\" label=\"Author\"></el-table-column>\r\n        </el-table>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n          <el-button size=\"small\" @click=\"dialogBookinfo = false\">cancel</el-button>\r\n        </div>\r\n      </el-dialog>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { books_api, getBooks_api,upBooks_api,addBooks_api,deleteBooks_api,getAuthorinfo,getBookinfo } from '@/api'\r\nimport moment from 'moment' // 时间过滤插件\r\nexport default {\r\n  data() {\r\n    return {\r\n      common: ['Book Info'], // 公共组件传值\r\n      input1: '',\r\n      value1: '',\r\n      allCount:null,\r\n      currentPage:1,\r\n      pageSize:10,\r\n      tableData: [],\r\n      gridData:[],\r\n      bookData: [],\r\n      dialogFormVisible:false,\r\n\t  editFormVisible: false,\r\n    dialoginfo:false,\r\n    dialogBookinfo: false,\r\n    show:true,\r\n\t  addForm: {\r\n\t  \ttitle: '',\r\n\t  \tisbn: '',\r\n\t  \tname: ''\r\n\t  },\r\n\t  editRegion: {\r\n\t  \ttitle: '',\r\n\t  \tisbn: '',\r\n\t  \tname: ''\r\n\t  },\r\n\t  formLabelWidth: '140px',\r\n\t  rules: {\r\n        title: [{ required: true, message: 'please input title', trigger: 'blur' }],\r\n\t  \tisbn: [{ required: true, message: 'please input number', trigger: 'blur' },\r\n          { type: 'string',\r\n            pattern: /^[0-9]{1,22}$/, // 正则表达式验证\r\n            message: 'Please enter a number number！',\r\n            trigger: 'blur'\r\n          }],\r\n\t  \tname: [{ required: true, message: 'please input author', trigger: 'blur' }]\r\n\t  }\r\n    }\r\n  },\r\n  filters: {\r\n    formatDate: function (value) {\r\n      return moment(value).format('YYYY-MM-DD')\r\n    }\r\n  },\r\n  created() {\r\n    this.getBookAll()\r\n  },\r\n  methods: {\r\n    // 清除clearInput\r\n    clear(){\r\n      this.show = true;\r\n        this.getBookAll()\r\n    },\r\n    //获取图书信息\r\n    openBook(id) {\r\n      var params = {\r\n        id:id\r\n      }\r\n      getBookinfo(params).then(res=>{\r\n        if(res.status == 200){\r\n          this.dialogBookinfo=true;\r\n          this.bookData = res.data.data\r\n        }\r\n      }).catch(err=>{console.log(err)})\r\n    },\r\n    //获取作者信息\r\n    open(id) {\r\n      var params = {\r\n        id:id\r\n      }\r\n      getAuthorinfo(params).then(res=>{\r\n        if(res.status == 200){\r\n          this.dialoginfo=true;\r\n          this.gridData = res.data.data\r\n        }\r\n      }).catch(err=>{console.log(err)})\r\n    },\r\n\r\n    async getBookAll() {\r\n      // 刷新home页面就请求图书信息\r\n      let params = {\r\n        \"pagesize\":this.pageSize,\r\n        \"pageNO\":this.currentPage\r\n      }\r\n      const { data: res } = await books_api(params)\r\n      if (res.status !== 200) return this.$message.error(res.msg)\r\n      for (var i in res.data) {\r\n        res.data[i].createdAt = moment(res.data[i].createdAt).format('YYYY-MM-DD')\r\n      }\r\n\t\t\t// console.log(res)\r\n      this.tableData = res.data\r\n      this.allCount = res.total\r\n    },\r\n    //分页\r\n    async handleCurrentChange(currentPage){\r\n      this.currentPage = currentPage;\r\n      let params = {\r\n        \"pagesize\":this.pageSize,\r\n        \"pageNO\":this.currentPage\r\n      }\r\n      const { data: res } = await books_api(params)\r\n      if (res.status !== 200) return this.$message.error(res.msg)\r\n      for (var i in res.data) {\r\n        res.data[i].createdAt = moment(res.data[i].createdAt).format('YYYY-MM-DD')\r\n      }\r\n      // console.log(res)\r\n      this.tableData = res.data\r\n      this.allCount = res.total\r\n    },\r\n\t  reset() { // 重置功能\r\n\t  \tthis.input1 = '',\r\n\t  \tthis.value1 = ''\r\n\t  },\r\n    //add\r\n    submitForm(formName){\r\n        var that = this\r\n    \tthis.$refs[formName].validate((valid) =>{\r\n    \t\tif(valid){\r\n    \t\t\tvar params ={\r\n            \"bookTitle\": that.addForm.title,\r\n            \"bookIsbn\":that.addForm.isbn,\r\n            \"authorName\":that.addForm.name\r\n          }\r\n    \t\t\tthis.$confirm('Whether to commit',{\r\n    \t\t\t\tconfirmButtonText:'confirm',\r\n    \t\t\t\tcancelButtonText:'cancel',\r\n    \t\t\t\ttype:'warning',\r\n    \t\t\t\tcenter:true\r\n    \t\t\t})\r\n    \t\t\t.then(function(){\r\n    \t\t\t\t//ajax\r\n    \t\t\t\taddBooks_api(params).then(res =>{\r\n    \t\t\t\t\tif(res.data.status === 200){ //此处的表单验证\r\n    \t\t\t\t\t\tthat.dialogFormVisible = false\r\n    \t\t\t\t\t\tthat.getBookAll() //重新渲染数据\r\n    \t\t\t\t\t}else{\r\n    \t\t\t\t\tthat.$confirm(res.result.msg, 'hint', {\r\n                      type: 'warning'\r\n                 \t})\r\n    \t\t\t\t}\r\n    \t\t\t\t}).catch(err =>{console.log(err)})\r\n    \t\t\t})\r\n    \t\t\t.catch(function(err){\r\n    \t\t\t\tconsole.log('Cancel')\r\n    \t\t\t})\r\n    \t\t} else {\r\n    \t\t\treturn false\r\n    \t\t}\r\n    \t})\r\n    },\r\n\t  // edit\r\n\t  handleEdit(index, row) {\r\n\t      this.editFormVisible = true\r\n\t      this.editRegion = Object.assign({}, row) // 这句是关键！！！\r\n\t  },\r\n\t  editSubmitRegion (formName) {\r\n\t  \tvar that = this\r\n\t  \tthis.$refs[formName].validate((valid) => {\r\n\t  \t\tif (valid) {\r\n\t  \t\tvar params ={\r\n          \"bookId\":that.editRegion.id,\r\n          \"authorName\":that.editRegion.name,\r\n          \"bookTitle\":that.editRegion.title,\r\n          \"bookIsbn\":that.editRegion.isbn\r\n        }\r\n        // console.log(params)\r\n\t  \t\t\tthis.$confirm('Whether to commit',{\r\n\t  \t\t\t\tconfirmButtonText:'confirm',\r\n\t  \t\t\t\tcancelButtonText:'cancel',\r\n\t  \t\t\t\ttype:'warning',\r\n\t  \t\t\t\tcenter:true\r\n\t  \t\t\t})\r\n\t  \t\t\t.then(function(){\r\n\t  \t\t\t\t//ajax\r\n\t  \t\t\t\tupBooks_api(params).then(res =>{\r\n              console.log(res.data.status)\r\n\t  \t\t\t\t\tif(res.data.status === 200){\r\n\t  \t\t\t\t\t\tthat.editFormVisible = false\r\n\t  \t\t\t\t\t\tthat.getBookAll() //重新渲染数据\r\n\t  \t\t\t\t\t}else if(res.result.status == 2){\r\n\t  \t\t\t\t\t\tthat.$confirm(res.result.msg, 'hint', {\r\n\t                    type: 'warning'\r\n\t               \t})\r\n\t  \t\t\t\t\t}\r\n\t  \t\t\t\t}).catch(err =>{console.log(err)})\r\n\t  \t\t\t})\r\n\t  \t\t\t.catch(function(err){\r\n\t  \t\t\t\tconsole.log('Cancel')\r\n\t  \t\t\t})\r\n\t  \t\t} else {\r\n\t  \t\t\treturn false\r\n\t  \t\t}\r\n\t  \t})\r\n\t  },\r\n\t  // query\r\n\t  searchClick() { // 查询功能\r\n\t  \t// 获取当前页面的信息，发送给后台 刷新页面\r\n\r\n\t  \tconst nameCom = this.input1 // 书名\r\n\t  \tconst cardCom = this.value1 // 书名编号\r\n\r\n      if(nameCom == '' && cardCom == ''){\r\n        this.show = true;\r\n        this.getBookAll()\r\n      }else{\r\n        var  params = {\r\n          \"bookTitle\": nameCom,\r\n          \"bookIsbn\": parseInt(cardCom)\r\n        }\r\n        getBooks_api(params).then(res => {\r\n          if (res.data.status !== 200) {\r\n            return this.$message.error(res.data.msg)\r\n          } else {\r\n            // res.data.data.createdAt = moment(res.data.data.createdAt).format('YYYY-MM-DD')\r\n            var arr = []\r\n            arr.push(res.data.data)\r\n            this.tableData = arr\r\n            this.show = false;\r\n          }\r\n        })\r\n      }\r\n\t  },\r\n\t  // delete\r\n\t  handleDelete (index, row) {\r\n\t      var _self = this\r\n\t      this.$confirm('Are you sure to delete?', 'hint', {\r\n\t          confirmButtonText: 'delete',\r\n            cancelButtonText: 'waiting',\r\n            type: 'warning',\r\n            center: true\r\n              }).then(function() {\r\n            let params = {\r\n              bookId:row.id\r\n            }\r\n        deleteBooks_api({data:params}).then(res => {\r\n          console.log(res)\r\n        \tif(res.status == 200){\r\n        \t\t_self.$message({\r\n        \t\t  message: 'successfully delete',\r\n        \t\t  type: 'success'\r\n        \t  });\r\n        _self.getBookAll() //重新渲染数据\r\n        \t}\r\n        }).catch(err =>{console.log(err)})\r\n\t\t\t\t  }).catch(function(e) {\r\n\t\t\t\t\t  if (e != 'cancel') { console.log('error' + e) }\r\n\t\t\t\t  })\r\n\t\t  }\r\n  },\r\n  mounted() {\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.item {\r\n  margin-top: 10px;\r\n  margin-right: 40px;\r\n}\r\n.checking{\r\n  margin: 20px 0;\r\n  .codeName{\r\n    width: 12.5rem;margin-right: 10px;\r\n  }\r\n  .add{float: right;}\r\n}\r\n.page_size{display: inline-block;float: right;}\r\n.author{text-decoration:none;}\r\n</style>\r\n"],"sourceRoot":"src/components/Book"}]}